<?php
/**
 * Checkout.com
 * Authorized and regulated as an electronic money institution
 * by the UK Financial Conduct Authority (FCA) under number 900816.
 *
 * PHP version 8
 *
 * @category  Magento2
 * @package   Checkout.com
 * @author    Platforms Development Team <platforms@checkout.com>
 * @copyright 2010-present Checkout.com
 * @license   https://opensource.org/licenses/mit-license.html MIT License
 * @link      https://docs.checkout.com/
 */


use CheckoutCom\Magento2\Block\Adminhtml\Order\View\View;
use Magento\Framework\Escaper;

/**
 * @var View $block
 * @var Escaper $escape
 */

$alternativePaymentMethodName = $block->getAlternativePaymentMethodName();
$alternativePaymentMethodTransactionInfo = $block->getAlternativePaymentMethodTransactionInfo();
$avsCheck = $block->getCkoPaymentData('avs_check');
$cvvCheck = $block->getCkoPaymentData('cvv_check');
$threeDsCode = $block->getCko3dsPaymentData('authentication_response');
$issuer = $block->getCkoPaymentData('issuer');
$threeDsVersion = $block->getCko3dsPaymentData('version');
?>

<?php if ($alternativePaymentMethodName || ($block->getCkoPaymentData('product_type') && $block->getCkoPaymentData('last4'))) : ?>
    <div class="order-account-information">
        <div class="field-email">
            <div class="admin__page-section-title">
                <h2 class="title"><?= $escape->escapeHtml(__('Payment Additional Information')) ?></h2>
            </div>
            <table class="admin__table-secondary order-information-table">
                <?php if ($alternativePaymentMethodName !== '') : ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Alternative payment method')) ?></th>
                        <td><?= $alternativePaymentMethodName ?></td>
                    </tr>
                    <?php if ($alternativePaymentMethodTransactionInfo !== '') : ?>
                        <tr>
                            <th><?= $escape->escapeHtml(__('Transaction Id')) ?></th>
                            <td><?= $alternativePaymentMethodTransactionInfo ?></td>
                        </tr>
                    <?php endif ?>
                <?php endif ?>
                <?php if ($block->getCkoPaymentData('product_type') && $block->getCkoPaymentData('last4')) : ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Card type')) ?></th>
                        <td><?= $block->getCkoPaymentData('scheme') ?> (<?= $block->getCkoPaymentData('product_type') ?>)</td>
                    </tr>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Card 4 last numbers')) ?></th>
                        <td>**** **** **** <?= $block->getCkoPaymentData('last4') ?></td>
                    </tr>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Card expiry (mm/yy)')) ?></th>
                        <td><?= $block->getCkoPaymentData('expiry_month') ?>/<?= $block->getCkoPaymentData('expiry_year') ?></td>
                    </tr>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Card Country')) ?></th>
                        <td><?= $block->getCkoPaymentData('issuer_country') ?></td>
                    </tr>
                <?php endif ?>
                <?php if ($issuer): ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('Issuing Bank')) ?></th>
                        <td><?= $issuer ?></td>
                    </tr>
                <?php endif ?>
                <?php if ($avsCheck): ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('AVS Check')) ?></th>
                        <td><?= $avsCheck ?> (<?= $block->getAvsCheckDescription($avsCheck) ?>)</td>
                    </tr>
                <?php endif ?>
                <?php if ($cvvCheck): ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('CVV Check')) ?></th>
                        <td><?= $cvvCheck ?> (<?= $block->getCvvCheckDescription($cvvCheck) ?>)</td>
                    </tr>
                <?php endif ?>
                <?php if ($threeDsCode): ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('3DS authorization code')) ?></th>
                        <td><?= $threeDsCode ?> (<?= $block->get3dsDescription($threeDsCode) ?>)</td>
                    </tr>
                <?php endif ?>
                <?php if ($threeDsVersion): ?>
                    <tr>
                        <th><?= $escape->escapeHtml(__('3DS version')) ?></th>
                        <td><?= $threeDsVersion ?></td>
                    </tr>
                <?php endif ?>
            </table>
        </div>
    </div>
<?php endif ?>
